setwd("Capstone/github/chetan mishra sandbox/")
source("webscraping westboro_methods.R")
sermon_links <- "http://www.godhatesfags.com/sermons/outlines/"
sermon_links_html <- get_webpage_html(sermon_links)
sermon_pdfs <- unlist(str_extract_all(sermon_links_html, "Sermon_\\d{8}.pdf"))
text_cache <- list()
texts <- lapply(sermon_pdfs[1:3], function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
save(text_cache, file="text_cache.RData")
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
str(text_cache)
text_cache[["http://www.godhatesfags.com/sermons/outlines/Sermon_20130623.pdf"]]
str(text_cache[["http://www.godhatesfags.com/sermons/outlines/Sermon_20130623.pdf"]])
save(text_cache, file="text_cache.RData")
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
"http://www.godhatesfags.com/sermons/outlines/Sermon_20090118.pdf"
missing_files <- c(
"http://www.godhatesfags.com/sermons/outlines/Sermon_20090118.pdf"
)
sermon_pdfs <- setdiff(sermon_pdfs, missing_files)
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
sermon_pdfs <- setdiff(sermon_pdfs, missing_files)
sermon_pdfs <- setdiff(sermon_pdfs, missing_files)
sermon_pdfs <- unlist(str_extract_all(sermon_links_html, "Sermon_\\d{8}.pdf"))
missing_files <- c(
"http://www.godhatesfags.com/sermons/outlines/Sermon_20090118.pdf"
)
sermon_pdfs <- setdiff(sermon_pdfs, missing_files)
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
sermon_pdfs[str_match(sermon_pdfs, "20090118")]
save(text_cache, file="text_cache.RData")
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
pdf
pdf
sermon_pdfs[338:340]
head(sermon_pdfs)
sermon_pdfs <- unlist(str_extract_all(sermon_links_html, "Sermon_\\d{8}.pdf"))
missing_files <- c(
"Sermon_20090118.pdf"
)
sermon_pdfs <- setdiff(sermon_pdfs, missing_files)
?setdiff
sermon_pdfs
sermon_pdfs <- unlist(str_extract_all(sermon_links_html, "Sermon_\\d{8}.pdf"))
sermon_pdfs2 <- setdiff(sermon_pdfs, missing_files)
unique(sermon_pdfs)
sermon_pdfs[338:340]
sermon_pdfs[338:341]
?unique
missing_files <- c(
"Sermon_20090118.pdf"
)
sermon_pdfs <- setdiff(sermon_pdfs, missing_files)
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
missing_files <- c(
"Sermon_20090118.pdf",
"Sermon_20070520.pdf"
)
sermon_pdfs <- setdiff(sermon_pdfs, missing_files)
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
str(sermon_pdfs)
save(text_cache, file="text_cache.RData")
Sys.size(sermons_pdfs)
object.size(sermons_pdfs)
str(texts)
str(texts[[1]])
texts <- lapply(texts, function(txt) paste(txt, collape=""))
str(texts[[1]])
str(texts[[1]])
texts[[1]]
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
paste(text_cache[[pdf_link]], collapse="")
})
texts
texts <- lapply(sermon_pdfs, function(pdf) {
pdf_link <- paste0(sermon_links, pdf)
if (!pdf_link %in% names(text_cache)) {
download.file(url=pdf_link,
destfile="temp_pdf.pdf",
method="auto",
quiet=F,
mode="wb")
text_cache[[pdf_link]] <<- pdf_to_text("temp_pdf.pdf", "pdftotext.exe")
}
text_cache[[pdf_link]]
})
texts <- lapply(texts, function(txt) paste(txt, collape=""))
str(texts[[1]])
texts[[1]]
paste(texts[[1]], collapse="")
lapply(texts[[1]], function(txt) paste(txt, collape=""))
class(texts[[1]])
save(text_cache, file="text_cache.RData")
